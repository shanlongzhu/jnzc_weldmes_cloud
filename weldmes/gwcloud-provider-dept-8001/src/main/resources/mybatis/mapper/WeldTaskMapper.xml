<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gw.data.weldTask.dao.WeldTaskDao">

    <resultMap id="realtimeData" type="com.gw.entities.RealtimeData">
        <id property="id"  column="id"></id>
        <result property="fwelderId" column="fwelder_id"></result>
        <result property="fgatherNo" column="fgather_no"></result>
        <result property="fmachineId" column="fmachine_id"></result>
        <result property="fjunctionId" column="fjunction_id"></result>
        <result property="fItemId" column="fitemid"></result>
        <result property="fElectricity" column="felectricity"></result>
        <result property="fVoltage" column="fvoltage"></result>
        <result property="fRateOfFlow" column="frate_of_flow"></result>
        <result property="fStatus" column="fstatus"></result>
        <result property="fWelderNo" column="fwelder_no"></result>
        <result property="fJunctionNo" column="fjunction_no"></result>
        <result property="fWeldNo" column="fweld_no"></result>
        <result property="fChannel" column="fchannel"></result>
        <result property="fMaxElectricity" column="fmax_electricity"></result>
        <result property="fMinElectricity" column="fmin_electricity"></result>
        <result property="fMaxVoltage" column="fmax_voltage"></result>
        <result property="fMinVoltage" column="fmin_voltage"></result>
        <result property="fWelderItemId" column="fwelder_itemid"></result>
        <result property="fJunctionItemId" column="fjunction_itemid"></result>
        <result property="fMachineItemId" column="fmachine_itemid"></result>
        <result property="fWireFeedRate" column="fwirefeedrate"></result>
        <result property="fWeldingRate" column="fweldingrate"></result>
        <result property="fMachineModel" column="fmachinemodel"></result>
        <result property="fWireDiameter" column="fwirediameter"></result>
        <result property="fMaterialGas" column="fmaterialgas"></result>
        <result property="fWeldTime" column="fweldtime"></result>
        <result property="fSolderLayer" column="fsolder_layer"></result>
        <result property="fWeldBead" column="fweld_bead"></result>
        <result property="count" column="count"></result>
        <result property="count2" column="count2"></result>
        <result property="count3" column="count3"></result>
        <result property="count4" column="count4"></result>
        <result property="count5" column="count5"></result>
        <result property="utilization" column="utilization"></result>
        <result property="time" column="time"></result>
        <result property="time2" column="time2"></result>
        <result property="utilization2" column="utilization2"></result>
        <association property="sysDept" javaType="com.gw.entities.SysDept">
            <id property="id" column="id"></id>
            <result property="name" column="name"></result>
            <result property="parentId" column="parent_id"></result>
        </association>
        <association property="taskInfo" javaType="com.gw.entities.TaskInfo">
            <id property="id" column="id"></id>
            <result property="taskNo" column="task_no"></result>
            <result property="status" column="status"></result>
        </association>
        <association property="sysDictionary" javaType="com.gw.entities.SysDictionary">
            <id property="id" column="id"></id>
            <result property="valueName" column="value_name"></result>
        </association>
    </resultMap>

    <select id="getList" resultMap="realtimeData">
SELECT
	s.NAME,
    s.parent_id,
	r.fweld_no,
	r.fweldtime,
	t.task_no,
	t.`status`,
	d.value_name
FROM
	realtime_data r,
	sys_dept s,
	task_info t,
	sys_dictionary d
        <where>
            r.fmachine_itemid = s.id
            AND r.fjunction_id = t.id
            AND t.`status` = d.id
            <if test="time1!=null and time1!=''">
                and r.fWeldTime &gt;= #{time1}
            </if>
            <if test="time2!=null and time2!=''">
                and r.fWeldTime &lt;= #{time2}
            </if>
            <if test="areaId!=null and areaId!=''">
                and s.parent_id = #{areaId}
            </if>
            <if test="teamName!=null and teamName!=''">
                and s.name = #{teamName}
            </if>
            <if test="valueName!=null and valueName!=''">
                and d.value_name = #{valueName}
            </if>
        </where>
    </select>
    <select id="getTeamName" resultType="java.lang.String">
        select name from sys_dept where id=#{teamId}
    </select>
    <select id="getValueName" resultType="java.lang.String">
        select value_name from sys_dictionary where id=#{status}
    </select>


</mapper>