<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.gw.sys.dao.UserRolesAndPerDao">

    <resultMap id="sysMenuResMap" type="com.gw.entities.SysMenuInfo">
        <result property="id" column="id"></result>
        <result property="name" column="name"></result>
        <result property="url" column="url"></result>
        <result property="perms" column="perms"></result>
        <result property="type" column="type"></result>
        <result property="icon" column="icon"></result>
        <result property="orderNum" column="order_num"></result>
        <result property="del_flag" column="del_flag"></result>
    </resultMap>

    <!--根据用户名和密码查询用户登录信息-->
    <select id="queryUserInfoByUserNameAndPwd" resultType="com.gw.entities.UserOfSys">
        select id,`name`,password,status from sys_user where `name` = #{userName}
    </select>

    <!--通过菜单id 查询 菜单目录信息-->
    <select id="queryMenuInfoByMenuId" resultMap="sysMenuResMap">
        select id,`name`,url,`type`,icon,order_num,del_flag
        from sys_menu
        where del_flag = 0 and id = #{id}
    </select>

    <!--根据菜单父级id 查询 子菜单信息-->
    <select id="querySecondMenuInfo" resultMap="sysMenuResMap">
        select `name`,url,perms,`type`,icon,order_num,del_flag
        from sys_menu
        where del_flag = 0 and parent_id = #{id}
    </select>

    <!--通过用户id查询用户角色id-->
    <select id="queryUserRoleIds" resultType="java.lang.Long">
        select role_id from sys_user_role
        where user_id = #{id}
    </select>

    <!--通过用户角色id查询用户角色名称-->
    <select id="queryUserRoleName" resultType="java.lang.String">
        select `name` from sys_role
        where id = #{id} and del_flag = 0
    </select>

    <!--通过用户角色id查询用户菜单id-->
    <select id="queryMenuIdByRoleId" resultType="java.lang.Long">
        select menu_id from sys_role_menu
        where role_id = #{id}
    </select>

    <!--通过菜单目录id、角色id 查询 子菜单id-->
    <select id="queryChildrenMenuIdBySuperMenuIdAndRoleId" resultType="java.lang.Long">
        select menu_id from sys_role_auth_menu
        where super_menu_id = #{superMenuId} and role_id = #{roleId} and del_flag = 0
    </select>

</mapper>